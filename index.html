<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="version" content="2.0.3">
    <meta name="description" content="ef-sin Inventur v2.0.3 - Professional & Clean">
    <title>ef-sin Inventur v2.0</title>

    <!-- ORIGINAL -->
    <link rel="stylesheet" href="styles.css">

    <!-- NEU (NUR ERG√ÑNZT) -->
    <link rel="stylesheet" href="dark-mode.css">
    <link rel="stylesheet" href="icon-picker.css">
</head>
<body>

<!-- ================= HEADER ================= -->
<header class="app-header">
    <div class="header-left">
        <h1>üì¶ ef-sin Inventur <span class="version">v2.0</span></h1>
    </div>
    <div class="header-right">

        <!-- NEU: Dark Mode Button (zus√§tzlich, nichts ersetzt) -->
        <button id="themeToggle" class="btn-icon" title="Dark Mode umschalten">
            <span id="themeIcon">üåô</span>
        </button>

        <!-- ORIGINAL -->
        <button id="syncButton" class="btn-icon" title="GitHub Sync">üîÑ</button>
        <button id="menuButton" class="btn-icon" title="Men√º">‚ò∞</button>
    </div>
</header>

<!-- ================= KATEGORIE TABS ================= -->
<nav class="category-tabs" id="categoryTabs"></nav>

<!-- ================= ACTION BUTTONS (ORIGINAL) ================= -->
<div class="action-buttons">
    <button id="addNormalButton" class="btn-primary">
        <span class="btn-icon">+</span>
        <span class="btn-text">Artikel</span>
    </button>
    <button id="addQuickButton" class="btn-success">
        <span class="btn-icon">‚ö°</span>
        <span class="btn-text">Quick Add</span>
    </button>
</div>

<!-- ================= SUCHE ================= -->
<div class="search-container">
    <input type="text" id="searchInput" placeholder="üîç Suchen...">
</div>

<!-- ================= ARTIKEL LISTE ================= -->
<main class="items-container" id="itemsContainer"></main>

<!-- ================= LOADING ================= -->
<div class="loading-overlay" id="loadingOverlay">
    <div class="spinner"></div>
    <p>Lade...</p>
</div>

<!-- ================= ARTIKEL MODAL (ORIGINAL) ================= -->
<div class="modal" id="addModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="modalTitle">Artikel</h2>
            <button class="btn-close" onclick="app.closeModal()">√ó</button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label for="itemCategory">Kategorie *</label>
                <select id="itemCategory" required></select>
            </div>
            <div class="form-group">
                <label for="itemName">Name *</label>
                <input type="text" id="itemName" required>
            </div>
            <div class="form-group">
                <label for="itemSKU">SKU</label>
                <input type="text" id="itemSKU">
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="itemStock">Bestand *</label>
                    <input type="number" id="itemStock" required>
                </div>
                <div class="form-group">
                    <label for="itemUnit">Einheit</label>
                    <select id="itemUnit">
                        <option>St√ºck</option>
                        <option>Meter</option>
                        <option>Kilogramm</option>
                        <option>Liter</option>
                        <option>Paket</option>
                    </select>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="itemMin">Min</label>
                    <input type="number" id="itemMin">
                </div>
                <div class="form-group">
                    <label for="itemMax">Max</label>
                    <input type="number" id="itemMax">
                </div>
                <div class="form-group">
                    <label for="itemPrice">Preis (‚Ç¨)</label>
                    <input type="number" step="0.01" id="itemPrice">
                </div>
            </div>
            <div class="form-group">
                <label for="itemLocation">Standort</label>
                <input type="text" id="itemLocation">
            </div>
            <div class="form-group">
                <label for="itemNotes">Notizen</label>
                <textarea id="itemNotes" rows="3"></textarea>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn-secondary" onclick="app.closeModal()">Abbrechen</button>
            <button class="btn-primary" onclick="app.saveItem()">Speichern</button>
        </div>
    </div>
</div>

<!-- ================= QUICK ADD MODAL (ORIGINAL) ================= -->
<div class="modal" id="quickAddModal">
    <div class="modal-content quick-add">
        <div class="modal-header">
            <h2>‚ö° Schnelleingabe</h2>
            <button class="btn-close" onclick="quickAdd.close()">√ó</button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label for="quickCategory">Kategorie</label>
                <select id="quickCategory"></select>
            </div>
            <div class="form-group">
                <label for="quickSKU">SKU</label>
                <input type="text" id="quickSKU">
            </div>
            <div class="form-group">
                <label for="quickName">Name *</label>
                <input type="text" id="quickName" required>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="quickStock">Anzahl *</label>
                    <input type="number" id="quickStock" required>
                </div>
                <div class="form-group">
                    <label for="quickPrice">Preis</label>
                    <input type="number" step="0.01" id="quickPrice">
                </div>
            </div>
            <div class="form-group">
                <label for="quickLocation">Standort</label>
                <input type="text" id="quickLocation">
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn-primary" onclick="quickAdd.save()">Speichern</button>
        </div>
    </div>
</div>

<!-- ================= KATEGORIE EDIT MODAL (ORIGINAL + ERWEITERT) ================= -->
<div class="modal" id="categoryEditModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Kategorie</h2>
            <button class="btn-close" onclick="app.closeCategoryEditModal()">√ó</button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label for="catName">Name *</label>
                <input type="text" id="catName" required>
            </div>
            <div class="form-group">
                <label for="catIcon">Icon</label>
                <input type="text" id="catIcon" placeholder="üì¶" maxlength="2" readonly>
                <small>Icon anklicken zum Ausw√§hlen</small>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn-secondary" onclick="app.closeCategoryEditModal()">Abbrechen</button>
            <button class="btn-primary" onclick="app.saveCategory()">Speichern</button>
        </div>
    </div>
</div>

<!-- ================= MEN√ú (ORIGINAL) ================= -->
<div class="menu-overlay" id="menuOverlay" onclick="app.closeMenu()"></div>
<aside class="menu-sidebar" id="menuSidebar">
    <div class="menu-header">
        <h2>Men√º</h2>
        <button class="btn-close" onclick="app.closeMenu()">√ó</button>
    </div>
    <div class="menu-content">
        <button class="menu-item" onclick="app.showCategoryManagement(); app.closeMenu();">
            <span class="menu-icon">üìÅ</span>
            <span class="menu-text">Kategorien</span>
        </button>
        <button class="menu-item" onclick="app.exportData(); app.closeMenu();">
            <span class="menu-icon">üíæ</span>
            <span class="menu-text">Export</span>
        </button>
        <button class="menu-item" onclick="app.importData(); app.closeMenu();">
            <span class="menu-icon">üì•</span>
            <span class="menu-text">Import</span>
        </button>
        <button class="menu-item" onclick="app.showGitHubSettings(); app.closeMenu();">
            <span class="menu-icon">‚öôÔ∏è</span>
            <span class="menu-text">GitHub</span>
        </button>
        <button class="menu-item" onclick="app.manualSync(); app.closeMenu();">
            <span class="menu-icon">üîÑ</span>
            <span class="menu-text">Sync</span>
        </button>
    </div>
</aside>

<!-- ================= ICON PICKER MODAL (NEU, ZUS√ÑTZLICH) ================= -->
<div id="iconPickerModal" class="modal icon-picker-modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>üé® Icon ausw√§hlen</h2>
            <button class="close-btn" onclick="window.iconPicker.close()">&times;</button>
        </div>
        <div class="modal-body">
            <div class="icon-picker-search">
                <input type="text" id="iconSearchInput" placeholder="üîç Icon suchen...">
            </div>
            <div class="icon-picker-tabs" id="iconPickerTabs"></div>
            <div class="icon-picker-grid" id="iconPickerGrid"></div>
        </div>
    </div>
</div>

<!-- ================= SCRIPTS (ORIGINAL + ERG√ÑNZT) ================= -->
<script src="src/managers/CategoryManager.js"></script>
<script src="src/managers/ImageManager.js"></script>
<script src="src/managers/MultiFileGitHubSync.js"></script>
<script src="src/components/QuickAdd.js"></script>

<!-- NEU -->
<script src="src/components/IconPicker.js"></script>

<!-- ORIGINAL -->
<script src="app.js"></script>

<!-- ================= NEU: DARK MODE + ICON PICKER BINDING ================= -->
<script>
document.addEventListener('DOMContentLoaded', function () {

    /* Dark Mode */
    const html = document.documentElement;
    const toggle = document.getElementById('themeToggle');
    const icon = document.getElementById('themeIcon');

    const saved = localStorage.getItem('theme');
    const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const theme = saved || (systemDark ? 'dark' : 'light');

    html.setAttribute('data-theme', theme);
    icon.textContent = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';

    toggle.addEventListener('click', () => {
        const next = html.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
        html.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
        icon.textContent = next === 'dark' ? '‚òÄÔ∏è' : 'üåô';
    });

    /* Icon Picker */
    window.iconPicker = new IconPicker();
    const catIconInput = document.getElementById('catIcon');
    if (catIconInput) {
        catIconInput.addEventListener('click', () => {
            window.iconPicker.open({
                onSelect(icon) {
                    catIconInput.value = icon;
                    window.iconPicker.close();
                }
            });
        });
    }
});
</script>

</body>
</html>
