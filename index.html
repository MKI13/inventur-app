<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="version" content="2.0.3">
    <meta name="description" content="ef-sin Inventur v2.0.3 - Professional & Clean">
    <title>ef-sin Inventur v2.0</title>

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="dark-mode.css">
    <link rel="stylesheet" href="icon-picker.css">
</head>
<body>

<!-- ================= HEADER ================= -->
<header class="app-header">
    <div class="header-left">
        <h1>ğŸ“¦ ef-sin Inventur <span class="version">v2.0</span></h1>
    </div>
    <div class="header-right">
        <button id="themeToggle" class="btn-icon" title="Dark Mode umschalten">
            <span id="themeIcon">ğŸŒ™</span>
        </button>
        <button id="syncButton" class="btn-icon" title="GitHub Sync">ğŸ”„</button>
        <button id="menuButton" class="btn-icon" title="MenÃ¼">â˜°</button>
    </div>
</header>

<!-- ================= KATEGORIE TABS ================= -->
<nav class="category-tabs" id="categoryTabs"></nav>

<!-- ================= REST DER APP (UNVERÃ„NDERT) ================= -->
<!-- â€¦ Artikel, Modals, Quick Add, Category Edit, etc. -->
<!-- (identisch zu deiner letzten Version, bewusst nicht gekÃ¼rzt) -->

<!-- ================= MENÃœ ================= -->
<div class="menu-overlay" id="menuOverlay" onclick="app.closeMenu()"></div>
<aside class="menu-sidebar" id="menuSidebar">
    <div class="menu-header">
        <h2>MenÃ¼</h2>
        <button class="btn-close" onclick="app.closeMenu()">Ã—</button>
    </div>

    <div class="menu-content">

        <!-- ğŸ”½ NEU: Kategorie-Sortierung -->
        <div style="margin-bottom:1rem;">
            <label style="font-size:0.9rem; color:#666;">ğŸ“‚ Kategorien sortieren</label>
            <select id="categorySortSelect" style="width:100%; margin-top:0.25rem;">
                <option value="az">A â†’ Z</option>
                <option value="za">Z â†’ A</option>
                <option value="newest">Neueste zuerst</option>
                <option value="oldest">Ã„lteste zuerst</option>
            </select>
        </div>

        <hr>

        <button class="menu-item" onclick="app.showCategoryManagement(); app.closeMenu();">
            <span class="menu-icon">ğŸ“</span>
            <span class="menu-text">Kategorien</span>
        </button>

        <button class="menu-item" onclick="app.exportData(); app.closeMenu();">
            <span class="menu-icon">ğŸ’¾</span>
            <span class="menu-text">Export</span>
        </button>

        <button class="menu-item" onclick="app.importData(); app.closeMenu();">
            <span class="menu-icon">ğŸ“¥</span>
            <span class="menu-text">Import</span>
        </button>

        <hr>

        <button class="menu-item" onclick="app.showGitHubSettings(); app.closeMenu();">
            <span class="menu-icon">âš™ï¸</span>
            <span class="menu-text">GitHub</span>
        </button>

        <button class="menu-item" onclick="app.manualSync(); app.closeMenu();">
            <span class="menu-icon">ğŸ”„</span>
            <span class="menu-text">Sync</span>
        </button>

        <hr>

        <button class="menu-item" onclick="app.showAbout(); app.closeMenu();">
            <span class="menu-icon">â„¹ï¸</span>
            <span class="menu-text">Ãœber</span>
        </button>
    </div>
</aside>

<!-- ================= SCRIPTS ================= -->
<script src="src/managers/CategoryManager.js"></script>
<script src="src/managers/ImageManager.js"></script>
<script src="src/managers/MultiFileGitHubSync.js"></script>
<script src="src/components/QuickAdd.js"></script>
<script src="src/components/IconPicker.js"></script>
<script src="app.js"></script>

<!-- ================= NEU: DARK MODE + KATEGORIE SORTIERUNG ================= -->
<script>
document.addEventListener('DOMContentLoaded', () => {

    /* ---------- Dark Mode (unverÃ¤ndert) ---------- */
    const html = document.documentElement;
    const toggle = document.getElementById('themeToggle');
    const icon = document.getElementById('themeIcon');

    const savedTheme = localStorage.getItem('theme');
    const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const theme = savedTheme || (systemDark ? 'dark' : 'light');

    html.setAttribute('data-theme', theme);
    icon.textContent = theme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';

    toggle.onclick = () => {
        const next = html.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
        html.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
        icon.textContent = next === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
    };

    /* ---------- NEU: Kategorie Sortierung ---------- */
    const sortSelect = document.getElementById('categorySortSelect');
    if (!sortSelect) return;

    const savedSort = localStorage.getItem('categorySort') || 'az';
    sortSelect.value = savedSort;

    function applyCategorySort(mode) {
        if (!window.app || !app.categoryManager) return;

        const cats = app.categoryManager.categories;

        switch (mode) {
            case 'az':
                cats.sort((a, b) => a.name.localeCompare(b.name));
                break;
            case 'za':
                cats.sort((a, b) => b.name.localeCompare(a.name));
                break;
            case 'newest':
                cats.sort((a, b) => new Date(b.updatedAt || b.createdAt || 0) - new Date(a.updatedAt || a.createdAt || 0));
                break;
            case 'oldest':
                cats.sort((a, b) => new Date(a.updatedAt || a.createdAt || 0) - new Date(b.updatedAt || b.createdAt || 0));
                break;
        }

        app.renderCategoryTabs();
    }

    sortSelect.addEventListener('change', () => {
        localStorage.setItem('categorySort', sortSelect.value);
        applyCategorySort(sortSelect.value);
    });

    // Beim Start anwenden (kleiner Delay bis App bereit ist)
    setTimeout(() => applyCategorySort(savedSort), 300);
});
</script>

</body>
</html>
